{"version":3,"sources":["ChessBoard.js"],"names":[],"mappings":"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","file":"ChessBoard-compile.js","sourcesContent":["var ChessBoard = /** @class */ (function () {\r\n    function ChessBoard(width, height, position, color, relativelyDom, canvasDom, numOfchess) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.position = position;\r\n        this.color = color;\r\n        this.relativelyDom = relativelyDom;\r\n        this.canvasDom = canvasDom;\r\n        this.numOfchess = numOfchess;\r\n        this.chesses = [];\r\n        this.eachChess = [];\r\n        this.context = canvasDom.getContext(\"2d\");\r\n        for (var i = 0; i < numOfchess; i++) {\r\n            this.chesses[i] = [];\r\n            for (var j = 0; j < numOfchess; j++) {\r\n                this.chesses[i][j] = new chess(i, j, null, this.context, width / numOfchess, height / numOfchess);\r\n            }\r\n        }\r\n        this.step = 0;\r\n    }\r\n    ChessBoard.prototype.checkWinner = function (x, y) {\r\n        for (var i = -4; i <= 0; i++) {\r\n            try {\r\n                // 防止越界\r\n                if (x + 4 < 15) {\r\n                    // 横着连成五个\r\n                    if (this.chesses[x + i][y].color == this.chesses[x + i + 1][y].color &&\r\n                        this.chesses[x + i][y].color == this.chesses[x + i + 2][y].color &&\r\n                        this.chesses[x + i][y].color == this.chesses[x + i + 3][y].color &&\r\n                        this.chesses[x + i][y].color == this.chesses[x + i + 4][y].color) {\r\n                        if (this.step % 2 == 0)\r\n                            return 'black';\r\n                        else\r\n                            return 'white';\r\n                    }\r\n                }\r\n                if (y + 4 < 15) {\r\n                    // 竖着连成五个\r\n                    if (this.chesses[x][y + i].color == this.chesses[x][y + i + 1].color &&\r\n                        this.chesses[x][y + i].color == this.chesses[x][y + i + 2].color &&\r\n                        this.chesses[x][y + i].color == this.chesses[x][y + i + 3].color &&\r\n                        this.chesses[x][y + i].color == this.chesses[x][y + i + 4].color) {\r\n                        if (this.step % 2 == 0)\r\n                            return 'black';\r\n                        else\r\n                            return 'white';\r\n                    }\r\n                }\r\n                if (x + 4 < 15 && y + 4 < 15) {\r\n                    // 左上到右下\r\n                    if (this.chesses[x + i][y + i].color == this.chesses[x + i + 1][y + i + 1].color &&\r\n                        this.chesses[x + i][y + i].color == this.chesses[x + i + 2][y + i + 2].color &&\r\n                        this.chesses[x + i][y + i].color == this.chesses[x + i + 3][y + i + 3].color &&\r\n                        this.chesses[x + i][y + i].color == this.chesses[x + i + 4][y + i + 4].color) {\r\n                        if (this.step % 2 == 0)\r\n                            return 'black';\r\n                        else\r\n                            return 'white';\r\n                    }\r\n                }\r\n                if (x - 4 >= 0 && y + 4 < 15) {\r\n                    // 左下到右上\r\n                    if (this.chesses[x - i][y + i].color == this.chesses[x - i - 1][y + i + 1].color &&\r\n                        this.chesses[x - i][y + i].color == this.chesses[x - i - 2][y + i + 2].color &&\r\n                        this.chesses[x - i][y + i].color == this.chesses[x - i - 3][y + i + 3].color &&\r\n                        this.chesses[x - i][y + i].color == this.chesses[x - i - 4][y + i + 4].color) {\r\n                        if (this.step % 2 == 0)\r\n                            return 'black';\r\n                        else\r\n                            return 'white';\r\n                    }\r\n                }\r\n            }\r\n            catch (e) {\r\n            }\r\n        }\r\n        return 'no';\r\n    };\r\n    ChessBoard.prototype.move = function (absoluteX, absoluteY, quitFunction) {\r\n        //获得真实的XY\r\n        var x = Math.floor(absoluteX / (this.width / this.numOfchess));\r\n        console.log('x' + x);\r\n        var y = Math.floor(absoluteY / (this.height / this.numOfchess));\r\n        console.log('y' + y);\r\n        var color;\r\n        //判断是黑棋还是白\r\n        if (this.step % 2 == 0)\r\n            color = 'black';\r\n        else\r\n            color = 'white';\r\n        this.chesses[x][y].color = color;\r\n        this.chesses[x][y].draw(this.context);\r\n        var winner = this.checkWinner(x, y); //TODO: finish the winner checker\r\n        if (winner != 'no')\r\n            quitFunction(winner);\r\n        var theChess = new chess(x, y, color, this.context, this.width / this.numOfchess, this.height / this.numOfchess);\r\n        this.eachChess[this.eachChess.length] = theChess;\r\n        ++this.step;\r\n    };\r\n    ChessBoard.prototype.show = function (src) {\r\n        //设置高和宽\r\n        this.canvasDom.width = this.width;\r\n        this.canvasDom.height = this.height;\r\n        //获取棋盘材质\r\n        var img = new Image();\r\n        img.src = src;\r\n        this.context = this.canvasDom.getContext(\"2d\");\r\n        this.context.strokeStyle = \"black\";\r\n        this.context.strokeRect(0, 0, this.width, this.height);\r\n        var pattern = this.context.createPattern(img, 'repeat');\r\n        this.context.fillStyle = pattern;\r\n        this.context.fillRect(0, 0, this.width, this.height);\r\n        this.drawChessBoardLines(15);\r\n    };\r\n    ChessBoard.prototype.drawChessBoardLines = function (rows) {\r\n        var eachWidth = this.width / rows;\r\n        var eachHeight = this.height / rows;\r\n        for (var i = 0; i < rows; i++) {\r\n            this.context.moveTo(0, eachHeight * i);\r\n            this.context.lineTo(this.width, eachHeight * i);\r\n            this.context.stroke();\r\n            this.context.moveTo(eachWidth * i, 0);\r\n            this.context.lineTo(eachHeight * i, this.height);\r\n            this.context.stroke();\r\n        }\r\n    };\r\n    return ChessBoard;\r\n}());\r\nvar chess1 = /** @class */ (function () {\r\n    //color 可以为空，就是该位置没有棋子\r\n    function chess1(x, y, color, context, width, height) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.color = color;\r\n        this.context = context;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    chess1.prototype.draw = function (context) {\r\n        if (this.color === null) {\r\n            return;\r\n        }\r\n        var left = this.x * this.width + this.width / 2;\r\n        var top = this.y * this.height + this.height / 2;\r\n        if (this.color == \"black\") {\r\n            context.strokeStyle = \"#000000\";\r\n            context.fillstyle = \"#000000\";\r\n        }\r\n        else if (this.color == \"white\") {\r\n            context.strokeStyle = \"#ffffff\";\r\n            context.fillstyle = \"#ffffff\";\r\n        }\r\n        context.beginPath();\r\n        context.arc(left, top, this.width / 4 - 1, 0, Math.PI * 2, true);\r\n        context.closePath();\r\n        context.fill();\r\n        context.lineWidth = this.width / 2 - 1;\r\n        context.stroke();\r\n    };\r\n    return chess1;\r\n}());\r\n"]}